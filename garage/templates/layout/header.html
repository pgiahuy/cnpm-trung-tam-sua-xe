<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>

{% set current_path = request.path %}
{% set transparent_nav = current_path == '/' or current_path.startswith('/sparepart') %}

<nav id="mainNav"
     class="navbar navbar-expand-lg navbar-dark fixed-top
     {% if transparent_nav %}
        navbar-transparent
     {% else %}
        bg-dark
     {% endif %} mt+10">

    <div class="container-fluid px-4">


        <a class="navbar-brand fw-bold" href="/">GARAGE CENTER</a>

        <!-- TOGGLER -->
        <button class="navbar-toggler"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#mynavbar">
            <span class="navbar-toggler-icon"></span>
        </button>

        <!-- NAVBAR -->
        <div class="collapse navbar-collapse" id="mynavbar">

            <!-- MENU GIỮA -->
            <ul class="navbar-nav mx-auto mb-2 mb-lg-0 align-items-lg-center">

                <li class="nav-item">
                    <a class="nav-link {% if current_path == '/' %}active{% endif %}" href="/">
                        Trang chủ
                    </a>
                </li>

                {% for i in items %}
                <li class="nav-item">
                    <a class="nav-link {% if current_path.startswith('/' ~ i.url_name) %}active{% endif %}"
                       href="/{{ i.url_name }}">
                        {{ i.name }}
                    </a>
                </li>
                {% endfor %}

                {% if current_user.is_authenticated %}
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle fw-semibold"
                       href="#"
                       role="button"
                       data-bs-toggle="dropdown">
                        <i class="fa-regular fa-circle-user me-1"></i>
                        {{ current_user.customer.full_name }}
                    </a>

                    <ul class="dropdown-menu dropdown-menu-end shadow">

                        <li>
                            <a class="dropdown-item" href="/user/profile">
                                <i class="fa-solid fa-id-card me-2"></i> Hồ sơ cá nhân
                            </a>
                        </li>
                        <li>
                            <a class="dropdown-item" href="{{ url_for('user_vehicles') }}">
                                <i class="fa-solid fa-car me-2"></i> Xe của tôi
                            </a>
                        </li>
                        <li>
                            <a class="dropdown-item" href="/user/appointments">
                                <i class="fa-solid fa-calendar-check me-2"></i> Lịch sử đặt lịch
                            </a>
                        </li>
                        <li>
                            <a class="dropdown-item" href="{{ url_for('user_orders_history') }}">
                                <i class="fa-solid fa-receipt me-2"></i> Lịch sử mua hàng
                            </a>
                        </li>

                        <li><hr class="dropdown-divider"></li>

                        <li>
                            <a class="dropdown-item text-danger" href="{{ url_for('logout_my_user') }}">
                                <i class="fa-solid fa-arrow-right-from-bracket me-2"></i> Đăng xuất
                            </a>
                        </li>
                    </ul>
                </li>
                {% else %}
                <li class="nav-item">
                    <a class="nav-link" href="/login">
                        <i class="fa-regular fa-user me-1"></i> Đăng nhập
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/register">Đăng ký</a>
                </li>
                {% endif %}
            </ul>


            <div class="d-flex align-items-center gap-3">

                <form class="nav-search-glass" onsubmit="return searchAndScroll()">
                    <i class="fa-solid fa-magnifying-glass"></i>

                    <input id="searchInput"
                           type="text"
                           placeholder="Tìm trên trang…">

                    <span id="searchCounter"></span>

                    <button type="button" onclick="prevResult()" title="Trước">
                        <i class="fa-solid fa-chevron-up"></i>
                    </button>

                    <button type="button" onclick="nextResult()" title="Sau">
                        <i class="fa-solid fa-chevron-down"></i>
                    </button>
                </form>


                <div class="position-relative">
                    <a class="nav-link d-flex align-items-center cart-icon" href="/cart">
                        <i class="fa-solid fa-cart-shopping fs-5"></i>
                        <span class="cart-badge cart-counter" > {{stats_cart.total_quantity}}</span>

                    </a>
                </div>

            </div>

        </div>
    </div>
</nav>
