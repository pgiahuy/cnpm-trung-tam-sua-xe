{% extends "layout/base.html" %}

{% block title %}{{ _("Lịch sử đặt lịch - Garage Center") }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <h4 class="mb-4">
        {{ _("Lịch sử đặt lịch") }}
    </h4>

    {% if appointments %}
    <table class="table table-bordered table-hover align-middle">
        <thead class="table-primary">
            <tr>
                <th>{{ _("Ngày hẹn") }}</th>
                <th>{{ _("Xe") }}</th>
                <th>{{ _("Biển số") }}</th>
                <th>{{ _("Trạng thái") }}</th>
                <th>{{ _("Ghi chú") }}</th>
                <th>{{ _("Thao tác") }}</th>
            </tr>
        </thead>
        <tbody>
        {% for a in appointments %}
            <tr>
                <td>{{ a.schedule_time.strftime("%d/%m/%Y %H:%M") }}</td>
                <td>{{ a.vehicle.vehicle_type }}</td>
                <td>{{ a.vehicle.license_plate }}</td>
                <td>
                    <span class="badge bg-secondary">
                        {{ a.status.name }}
                    </span>
                </td>
                <td>{{ a.note or "-" }}</td>
                <td>
                    {% if a.status.name == "BOOKED" %}

                        <a href="{{ url_for('edit_appointment', appointment_id=a.id) }}"
                           class="btn btn-sm btn-warning">
                            {{ _("Chỉnh sửa") }}
                        </a>

                        <form action="{{ url_for('cancel_appointment', appointment_id=a.id) }}"
                              method="post"
                              style="display:inline;"
                              onsubmit="return confirm('{{ _('Bạn có chắc muốn hủy lịch này không?') }}');">
                            <button type="submit" class="btn btn-sm btn-danger">
                                {{ _("Hủy") }}
                            </button>
                        </form>
                    {% else %}
                        <em>—</em>
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% else %}
        <div class="alert alert-info">
            {{ _("Bạn chưa có lịch hẹn nào.") }}
        </div>
    {% endif %}
</div>
{% endblock %}